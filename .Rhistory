p.trues.6 <- list()
p.trues.6[[1]] <- c(0.05, 0.08, 0.10, 0.13, 0.15)
p.trues.6[[2]] <- c(0.09, 0.12, 0.15, 0.30, 0.45)
p.trues.6[[3]] <- c(0.15, 0.30, 0.45, 0.50, 0.60)
p.true.6 <- rbind(p.trues.6[[1]],p.trues.6[[2]],p.trues.6[[3]])
p.trues.7 <- list()
p.trues.7[[1]] <- c(0.07, 0.10, 0.12, 0.15, 0.30)
p.trues.7[[2]] <- c(0.15, 0.30, 0.45, 0.52, 0.60)
p.trues.7[[3]] <- c(0.30, 0.50, 0.60, 0.65, 0.75)
p.true.7 <- rbind(p.trues.7[[1]],p.trues.7[[2]],p.trues.7[[3]])
p.trues.8 <- list()
p.trues.8[[1]] <- c(0.02, 0.10, 0.15, 0.50, 0.60)
p.trues.8[[2]] <- c(0.05, 0.12, 0.30, 0.55, 0.70)
p.trues.8[[3]] <- c(0.08, 0.15, 0.45, 0.60, 0.80)
p.true.8 <- rbind(p.trues.8[[1]],p.trues.8[[2]],p.trues.8[[3]])
p.trues.9 <- list()
p.trues.9[[1]] <- c(0.10, 0.12, 0.30, 0.40, 0.45)
p.trues.9[[2]] <- c(0.15, 0.30, 0.37, 0.43, 0.48)
p.trues.9[[3]] <- c(0.30, 0.37, 0.42, 0.47, 0.52)
p.true.9 <- rbind(p.trues.9[[1]],p.trues.9[[2]],p.trues.9[[3]])
p.trues.10 <- list()
p.trues.10[[1]] <- c(0.01, 0.03, 0.06, 0.08, 0.10)
p.trues.10[[2]] <- c(0.04, 0.07, 0.12, 0.16, 0.30)
p.trues.10[[3]] <- c(0.08, 0.10, 0.15, 0.30, 0.50)
p.true.10 <- rbind(p.trues.10[[1]],p.trues.10[[2]],p.trues.10[[3]])
p.trues.11 <- list()
p.trues.11[[1]] <- c(0.06, 0.10, 0.15, 0.30, 0.50)
p.trues.11[[2]] <- c(0.10, 0.30, 0.50, 0.70, 0.80)
p.trues.11[[3]] <- c(0.50, 0.60, 0.70, 0.80, 0.90)
p.true.11 <- rbind(p.trues.11[[1]],p.trues.11[[2]],p.trues.11[[3]])
p.trues.12 <- list()
p.trues.12[[1]] <- c(0.05, 0.12, 0.20, 0.30, 0.40)
p.trues.12[[2]] <- c(0.10, 0.20, 0.30, 0.40, 0.50)
p.trues.12[[3]] <- c(0.30, 0.42, 0.52, 0.62, 0.70)
p.true.12 <- rbind(p.trues.12[[1]],p.trues.12[[2]],p.trues.12[[3]])
p.trues.13 <- list()
p.trues.13[[1]] <- c(0.12, 0.20, 0.30, 0.40, 0.60)
p.trues.13[[2]] <- c(0.20, 0.30, 0.40, 0.50, 0.67)
p.trues.13[[3]] <- c(0.42, 0.52, 0.62, 0.70, 0.80)
p.true.13 <- rbind(p.trues.13[[1]],p.trues.13[[2]],p.trues.13[[3]])
p.trues.14 <- list()
p.trues.14[[1]] <- c(0.04, 0.06, 0.08, 0.20, 0.30)
p.trues.14[[2]] <- c(0.10, 0.20, 0.30, 0.50, 0.67)
p.trues.14[[3]] <- c(0.30, 0.42, 0.52, 0.70, 0.80)
p.true.14 <- rbind(p.trues.14[[1]],p.trues.14[[2]],p.trues.14[[3]])
p <- array(c(p.true.1,p.true.2,p.true.3,p.true.4,p.true.5,p.true.6,p.true.7,p.true.8,p.true.9,p.true.10,p.true.11,p.true.12,p.true.13,p.true.14), dim = c(3,5,14))
source("2D_CFO_MTD.R")
source("pocrm.R")
library(dfcomb)
library(pocrm)
library(parallel)
#Specifiy the possible orderings from Section 3.3.
orders<-matrix(nrow=6,ncol=15)
orders[1,]<-c(1,4,7,10,13,2,5,8,11,14,3,6,9,12,15)
orders[2,]<-c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15)
orders[3,]<-c(1,2,4,3,5,7,6,8,10,9,11,13,12,14,15)
orders[4,]<-c(1,4,2,7,5,3,10,8,6,13,11,9,14,12,15)
orders[5,]<-c(1,2,4,7,5,3,6,8,10,13,11,9,12,14,15)
orders[6,]<-c(1,4,2,3,5,7,10,8,6,9,11,13,14,12,15)
#Specify the skeleton values.
skeleton<-getprior(0.03,0.30,13,15)
#Initial guesses of toxicity probabilities for each ordering.
alpha<-getwm(orders,skeleton)
#We consider all orders to be equally likely prior to the study.
prior.o<-rep(1/6,3)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
target <- 0.30
ncohort <- 20
cohortsize <- 3
init.level.A <- 1
init.level.B <- 1
n.cores <- detectCores()
prior_a1 = c(0.1, 0.2, 0.3)
prior_a2 = c(0.1, 0.2, 0.3, 0.4, 0.5)
prior_tox_a1 = c(0.2, 0.3, 0.4)
prior_tox_a2 = c(0.1, 0.2, 0.3, 0.4, 0.5)
order <- c(1,2,4,3,5,7,6,8,10,9,11,13,12,14,15)
seeds <- 1:5000
add.args <- list(alp.prior=target, bet.prior=1-target)
for (i in 1:100) {
res <- CFO.simu.fn(target, p.true.2, prelim=0, ncohort=46, cohortsize=3, init.level.A, init.level.B, add.args=add.args, seed=i)
cat(i)
}
source("2D_CFO_MTD.R")
source("pocrm.R")
library(parallel)
target <- 0.30
ncohort <- 20
cohortsize <- 3
init.level.A <- 1
init.level.B <- 1
n.cores <- detectCores()
prior_a1 = c(0.1, 0.2, 0.3)
prior_a2 = c(0.1, 0.2, 0.3, 0.4, 0.5)
prior_tox_a1 = c(0.2, 0.3, 0.4)
prior_tox_a2 = c(0.12, 0.2, 0.3, 0.4, 0.5)
seeds <- 1:5000
add.args <- list(alp.prior=target, bet.prior=1-target)
p.true.1 <- matrix(nrow=4,ncol=4)
p.true.1[1,] <- c(0.08, 0.14, 0.19, 0.30)
p.true.1[2,] <- c(0.10, 0.20, 0.30, 0.50)
p.true.1[3,] <- c(0.15, 0.30, 0.48, 0.60)
p.true.1[4,] <- c(0.30, 0.45, 0.60, 0.70)
p.true.2 <- matrix(nrow=4,ncol=4)
p.true.2[1,] <- c(0.10, 0.15, 0.30, 0.45)
p.true.2[2,] <- c(0.12, 0.30, 0.50, 0.55)
p.true.2[3,] <- c(0.30, 0.50, 0.55, 0.60)
p.true.2[4,] <- c(0.50, 0.55, 0.60, 0.70)
p.true.3 <- matrix(nrow=4,ncol=4)
p.true.3[1,] <- c(0.02, 0.11, 0.20, 0.30)
p.true.3[2,] <- c(0.10, 0.21, 0.30, 0.40)
p.true.3[3,] <- c(0.19, 0.40, 0.45, 0.60)
p.true.3[4,] <- c(0.30, 0.52, 0.60, 0.70)
p.true.4 <- matrix(nrow=4,ncol=4)
p.true.4[1,] <- c(0.05, 0.10, 0.15, 0.20)
p.true.4[2,] <- c(0.10, 0.15, 0.20, 0.30)
p.true.4[3,] <- c(0.15, 0.20, 0.45, 0.55)
p.true.4[4,] <- c(0.20, 0.30, 0.50, 0.60)
p.true.5 <- matrix(nrow=4,ncol=4)
p.true.5[1,] <- c(0.15, 0.30, 0.40, 0.45)
p.true.5[2,] <- c(0.30, 0.40, 0.48, 0.50)
p.true.5[3,] <- c(0.42, 0.45, 0.50, 0.52)
p.true.5[4,] <- c(0.48, 0.52, 0.55, 0.58)
p.true.6 <- matrix(nrow=4,ncol=4)
p.true.6[1,] <- c(0.06, 0.08, 0.10, 0.15)
p.true.6[2,] <- c(0.10, 0.18, 0.30, 0.45)
p.true.6[3,] <- c(0.15, 0.30, 0.45, 0.60)
p.true.6[4,] <- c(0.50, 0.55, 0.60, 0.70)
p.true.7 <- matrix(nrow=4,ncol=4)
p.true.7[1,] <- c(0.05, 0.15, 0.30, 0.45)
p.true.7[2,] <- c(0.10, 0.20, 0.40, 0.46)
p.true.7[3,] <- c(0.20, 0.30, 0.45, 0.61)
p.true.7[4,] <- c(0.42, 0.48, 0.60, 0.65)
p.true.8 <- matrix(nrow=4,ncol=4)
p.true.8[1,] <- c(0.15, 0.20, 0.40, 0.56)
p.true.8[2,] <- c(0.20, 0.30, 0.50, 0.60)
p.true.8[3,] <- c(0.40, 0.54, 0.62, 0.68)
p.true.8[4,] <- c(0.50, 0.60, 0.67, 0.73)
p.true.9 <- matrix(nrow=3,ncol=5)
p.true.9[1,] <- c(0.05, 0.10, 0.15, 0.30, 0.45)
p.true.9[2,] <- c(0.10, 0.15, 0.30, 0.45, 0.55)
p.true.9[3,] <- c(0.15, 0.30, 0.45, 0.50, 0.60)
p.true.10 <- matrix(nrow=3,ncol=5)
p.true.10[1,] <- c(0.02, 0.07, 0.10, 0.15, 0.30)
p.true.10[2,] <- c(0.07, 0.10, 0.20, 0.30, 0.55)
p.true.10[3,] <- c(0.30, 0.40, 0.45, 0.55, 0.60)
p.true.11 <- matrix(nrow=3,ncol=5)
p.true.11[1,] <- c(0.07, 0.10, 0.12, 0.30, 0.50)
p.true.11[2,] <- c(0.15, 0.30, 0.45, 0.52, 0.60)
p.true.11[3,] <- c(0.30, 0.45, 0.50, 0.65, 0.75)
p.true.12 <- matrix(nrow=3,ncol=5)
p.true.12[1,] <- c(0.15, 0.20, 0.30, 0.50, 0.60)
p.true.12[2,] <- c(0.20, 0.45, 0.50, 0.60, 0.75)
p.true.12[3,] <- c(0.30, 0.50, 0.60, 0.70, 0.80)
p.true.13 <- matrix(nrow=3,ncol=5)
p.true.13[1,] <- c(0.05, 0.08, 0.10, 0.13, 0.15)
p.true.13[2,] <- c(0.09, 0.12, 0.15, 0.30, 0.45)
p.true.13[3,] <- c(0.15, 0.30, 0.45, 0.50, 0.60)
p.true.14 <- matrix(nrow=3,ncol=5)
p.true.14[1,] <- c(0.30, 0.45, 0.60, 0.70, 0.80)
p.true.14[2,] <- c(0.45, 0.55, 0.65, 0.75, 0.85)
p.true.14[3,] <- c(0.50, 0.60, 0.70, 0.80, 0.90)
p.true.15 <- matrix(nrow=3,ncol=5)
p.true.15[1,] <- c(0.02, 0.07, 0.10, 0.15, 0.30)
p.true.15[2,] <- c(0.07, 0.10, 0.20, 0.30, 0.55)
p.true.15[3,] <- c(0.30, 0.40, 0.45, 0.55, 0.60)
p.true.16 <- matrix(nrow=3,ncol=5)
p.true.16[1,] <- c(0.01, 0.02, 0.08, 0.10, 0.11)
p.true.16[2,] <- c(0.03, 0.05, 0.10, 0.13, 0.15)
p.true.16[3,] <- c(0.07, 0.09, 0.12, 0.15, 0.30)
p.true.1 <- matrix(nrow=4,ncol=4)
p.true.1[1,] <- c(0.08, 0.14, 0.19, 0.30)
p.true.1[2,] <- c(0.10, 0.20, 0.30, 0.50)
p.true.1[3,] <- c(0.15, 0.30, 0.48, 0.60)
p.true.1[4,] <- c(0.30, 0.45, 0.60, 0.70)
p.true.2 <- matrix(nrow=4,ncol=4)
p.true.2[1,] <- c(0.10, 0.15, 0.30, 0.45)
p.true.2[2,] <- c(0.12, 0.30, 0.50, 0.55)
p.true.2[3,] <- c(0.30, 0.50, 0.55, 0.60)
p.true.2[4,] <- c(0.50, 0.55, 0.60, 0.70)
p.true.3 <- matrix(nrow=4,ncol=4)
p.true.3[1,] <- c(0.02, 0.11, 0.20, 0.30)
p.true.3[2,] <- c(0.10, 0.21, 0.30, 0.40)
p.true.3[3,] <- c(0.19, 0.40, 0.45, 0.60)
p.true.3[4,] <- c(0.30, 0.52, 0.60, 0.70)
p.true.4 <- matrix(nrow=4,ncol=4)
p.true.4[1,] <- c(0.05, 0.10, 0.15, 0.20)
p.true.4[2,] <- c(0.10, 0.15, 0.20, 0.30)
p.true.4[3,] <- c(0.15, 0.20, 0.45, 0.55)
p.true.4[4,] <- c(0.20, 0.30, 0.50, 0.60)
p.true.5 <- matrix(nrow=4,ncol=4)
p.true.5[1,] <- c(0.15, 0.30, 0.40, 0.45)
p.true.5[2,] <- c(0.30, 0.40, 0.48, 0.50)
p.true.5[3,] <- c(0.42, 0.45, 0.50, 0.52)
p.true.5[4,] <- c(0.48, 0.52, 0.55, 0.58)
p.true.6 <- matrix(nrow=4,ncol=4)
p.true.6[1,] <- c(0.06, 0.08, 0.10, 0.15)
p.true.6[2,] <- c(0.10, 0.18, 0.30, 0.45)
p.true.6[3,] <- c(0.15, 0.30, 0.45, 0.60)
p.true.6[4,] <- c(0.50, 0.55, 0.60, 0.70)
p.true.7 <- matrix(nrow=4,ncol=4)
p.true.7[1,] <- c(0.05, 0.15, 0.30, 0.45)
p.true.7[2,] <- c(0.10, 0.20, 0.40, 0.46)
p.true.7[3,] <- c(0.20, 0.30, 0.45, 0.61)
p.true.7[4,] <- c(0.42, 0.48, 0.60, 0.65)
p.true.8 <- matrix(nrow=4,ncol=4)
p.true.8[1,] <- c(0.15, 0.20, 0.40, 0.56)
p.true.8[2,] <- c(0.20, 0.30, 0.50, 0.60)
p.true.8[3,] <- c(0.40, 0.54, 0.62, 0.68)
p.true.8[4,] <- c(0.50, 0.60, 0.67, 0.73)
p.true.9 <- matrix(nrow=3,ncol=5)
p.true.9[1,] <- c(0.05, 0.10, 0.15, 0.30, 0.45)
p.true.9[2,] <- c(0.10, 0.15, 0.30, 0.45, 0.55)
p.true.9[3,] <- c(0.15, 0.30, 0.45, 0.50, 0.60)
p.true.10 <- matrix(nrow=3,ncol=5)
p.true.10[1,] <- c(0.02, 0.07, 0.10, 0.15, 0.30)
p.true.10[2,] <- c(0.07, 0.10, 0.20, 0.30, 0.55)
p.true.10[3,] <- c(0.30, 0.40, 0.45, 0.55, 0.60)
p.true.11 <- matrix(nrow=3,ncol=5)
p.true.11[1,] <- c(0.07, 0.10, 0.12, 0.30, 0.50)
p.true.11[2,] <- c(0.15, 0.30, 0.45, 0.52, 0.60)
p.true.11[3,] <- c(0.30, 0.45, 0.50, 0.65, 0.75)
p.true.12 <- matrix(nrow=3,ncol=5)
p.true.12[1,] <- c(0.15, 0.20, 0.30, 0.50, 0.60)
p.true.12[2,] <- c(0.20, 0.45, 0.50, 0.60, 0.75)
p.true.12[3,] <- c(0.30, 0.50, 0.60, 0.70, 0.80)
p.true.13 <- matrix(nrow=3,ncol=5)
p.true.13[1,] <- c(0.05, 0.08, 0.10, 0.13, 0.15)
p.true.13[2,] <- c(0.09, 0.12, 0.15, 0.30, 0.45)
p.true.13[3,] <- c(0.15, 0.30, 0.45, 0.50, 0.60)
p.true.14 <- matrix(nrow=3,ncol=5)
p.true.14[1,] <- c(0.30, 0.45, 0.60, 0.70, 0.80)
p.true.14[2,] <- c(0.45, 0.55, 0.65, 0.75, 0.85)
p.true.14[3,] <- c(0.50, 0.60, 0.70, 0.80, 0.90)
p.true.15 <- matrix(nrow=3,ncol=5)
p.true.15[1,] <- c(0.02, 0.07, 0.10, 0.15, 0.30)
p.true.15[2,] <- c(0.07, 0.10, 0.20, 0.30, 0.55)
p.true.15[3,] <- c(0.30, 0.40, 0.45, 0.55, 0.60)
p.true.16 <- matrix(nrow=3,ncol=5)
p.true.16[1,] <- c(0.01, 0.02, 0.08, 0.10, 0.11)
p.true.16[2,] <- c(0.03, 0.05, 0.10, 0.13, 0.15)
p.true.16[3,] <- c(0.07, 0.09, 0.12, 0.15, 0.30)
p <- array(c(p.true.1,p.true.2,p.true.3,p.true.4,p.true.5,p.true.6,p.true.7,p.true.8,p.true.9,p.true.10,p.true.11,p.true.12,p.true.13,p.true.14,p.true.15,p.true.16), dim = c(,,16))
p.true.1 <- matrix(nrow=4,ncol=4)
p.true.1[1,] <- c(0.08, 0.14, 0.19, 0.30)
p.true.1[2,] <- c(0.10, 0.20, 0.30, 0.50)
p.true.1[3,] <- c(0.15, 0.30, 0.48, 0.60)
p.true.1[4,] <- c(0.30, 0.45, 0.60, 0.70)
p.true.2 <- matrix(nrow=4,ncol=4)
p.true.2[1,] <- c(0.10, 0.15, 0.30, 0.45)
p.true.2[2,] <- c(0.12, 0.30, 0.50, 0.55)
p.true.2[3,] <- c(0.30, 0.50, 0.55, 0.60)
p.true.2[4,] <- c(0.50, 0.55, 0.60, 0.70)
p.true.3 <- matrix(nrow=4,ncol=4)
p.true.3[1,] <- c(0.02, 0.11, 0.20, 0.30)
p.true.3[2,] <- c(0.10, 0.21, 0.30, 0.40)
p.true.3[3,] <- c(0.19, 0.40, 0.45, 0.60)
p.true.3[4,] <- c(0.30, 0.52, 0.60, 0.70)
p.true.4 <- matrix(nrow=4,ncol=4)
p.true.4[1,] <- c(0.05, 0.10, 0.15, 0.20)
p.true.4[2,] <- c(0.10, 0.15, 0.20, 0.30)
p.true.4[3,] <- c(0.15, 0.20, 0.45, 0.55)
p.true.4[4,] <- c(0.20, 0.30, 0.50, 0.60)
p.true.5 <- matrix(nrow=4,ncol=4)
p.true.5[1,] <- c(0.15, 0.30, 0.40, 0.45)
p.true.5[2,] <- c(0.30, 0.40, 0.48, 0.50)
p.true.5[3,] <- c(0.42, 0.45, 0.50, 0.52)
p.true.5[4,] <- c(0.48, 0.52, 0.55, 0.58)
p.true.6 <- matrix(nrow=4,ncol=4)
p.true.6[1,] <- c(0.06, 0.08, 0.10, 0.15)
p.true.6[2,] <- c(0.10, 0.18, 0.30, 0.45)
p.true.6[3,] <- c(0.15, 0.30, 0.45, 0.60)
p.true.6[4,] <- c(0.50, 0.55, 0.60, 0.70)
p.true.7 <- matrix(nrow=4,ncol=4)
p.true.7[1,] <- c(0.05, 0.15, 0.30, 0.45)
p.true.7[2,] <- c(0.10, 0.20, 0.40, 0.46)
p.true.7[3,] <- c(0.20, 0.30, 0.45, 0.61)
p.true.7[4,] <- c(0.42, 0.48, 0.60, 0.65)
p.true.8 <- matrix(nrow=4,ncol=4)
p.true.8[1,] <- c(0.15, 0.20, 0.40, 0.56)
p.true.8[2,] <- c(0.20, 0.30, 0.50, 0.60)
p.true.8[3,] <- c(0.40, 0.54, 0.62, 0.68)
p.true.8[4,] <- c(0.50, 0.60, 0.67, 0.73)
p.true.9 <- matrix(nrow=3,ncol=5)
p.true.9[1,] <- c(0.05, 0.10, 0.15, 0.30, 0.45)
p.true.9[2,] <- c(0.10, 0.15, 0.30, 0.45, 0.55)
p.true.9[3,] <- c(0.15, 0.30, 0.45, 0.50, 0.60)
p.true.10 <- matrix(nrow=3,ncol=5)
p.true.10[1,] <- c(0.02, 0.07, 0.10, 0.15, 0.30)
p.true.10[2,] <- c(0.07, 0.10, 0.20, 0.30, 0.55)
p.true.10[3,] <- c(0.30, 0.40, 0.45, 0.55, 0.60)
p.true.11 <- matrix(nrow=3,ncol=5)
p.true.11[1,] <- c(0.07, 0.10, 0.12, 0.30, 0.50)
p.true.11[2,] <- c(0.15, 0.30, 0.45, 0.52, 0.60)
p.true.11[3,] <- c(0.30, 0.45, 0.50, 0.65, 0.75)
p.true.12 <- matrix(nrow=3,ncol=5)
p.true.12[1,] <- c(0.15, 0.20, 0.30, 0.50, 0.60)
p.true.12[2,] <- c(0.20, 0.45, 0.50, 0.60, 0.75)
p.true.12[3,] <- c(0.30, 0.50, 0.60, 0.70, 0.80)
p.true.13 <- matrix(nrow=3,ncol=5)
p.true.13[1,] <- c(0.05, 0.08, 0.10, 0.13, 0.15)
p.true.13[2,] <- c(0.09, 0.12, 0.15, 0.30, 0.45)
p.true.13[3,] <- c(0.15, 0.30, 0.45, 0.50, 0.60)
p.true.14 <- matrix(nrow=3,ncol=5)
p.true.14[1,] <- c(0.30, 0.45, 0.60, 0.70, 0.80)
p.true.14[2,] <- c(0.45, 0.55, 0.65, 0.75, 0.85)
p.true.14[3,] <- c(0.50, 0.60, 0.70, 0.80, 0.90)
p.true.15 <- matrix(nrow=3,ncol=5)
p.true.15[1,] <- c(0.02, 0.07, 0.10, 0.15, 0.30)
p.true.15[2,] <- c(0.07, 0.10, 0.20, 0.30, 0.55)
p.true.15[3,] <- c(0.30, 0.40, 0.45, 0.55, 0.60)
p.true.16 <- matrix(nrow=3,ncol=5)
p.true.16[1,] <- c(0.01, 0.02, 0.08, 0.10, 0.11)
p.true.16[2,] <- c(0.03, 0.05, 0.10, 0.13, 0.15)
p.true.16[3,] <- c(0.07, 0.09, 0.12, 0.15, 0.30)
p <- array(c(p.true.1,p.true.2,p.true.3,p.true.4,p.true.5,p.true.6,p.true.7,p.true.8,p.true.9,p.true.10,p.true.11,p.true.12,p.true.13,p.true.14,p.true.15,p.true.16), dim = c(4,4,16))
p
p.true.1 <- matrix(nrow=4,ncol=4)
p.true.1[1,] <- c(0.08, 0.14, 0.19, 0.30)
p.true.1[2,] <- c(0.10, 0.20, 0.30, 0.50)
p.true.1[3,] <- c(0.15, 0.30, 0.48, 0.60)
p.true.1[4,] <- c(0.30, 0.45, 0.60, 0.70)
p.true.2 <- matrix(nrow=4,ncol=4)
p.true.2[1,] <- c(0.10, 0.15, 0.30, 0.45)
p.true.2[2,] <- c(0.12, 0.30, 0.50, 0.55)
p.true.2[3,] <- c(0.30, 0.50, 0.55, 0.60)
p.true.2[4,] <- c(0.50, 0.55, 0.60, 0.70)
p.true.3 <- matrix(nrow=4,ncol=4)
p.true.3[1,] <- c(0.02, 0.11, 0.20, 0.30)
p.true.3[2,] <- c(0.10, 0.21, 0.30, 0.40)
p.true.3[3,] <- c(0.19, 0.40, 0.45, 0.60)
p.true.3[4,] <- c(0.30, 0.52, 0.60, 0.70)
p.true.4 <- matrix(nrow=4,ncol=4)
p.true.4[1,] <- c(0.05, 0.10, 0.15, 0.20)
p.true.4[2,] <- c(0.10, 0.15, 0.20, 0.30)
p.true.4[3,] <- c(0.15, 0.20, 0.45, 0.55)
p.true.4[4,] <- c(0.20, 0.30, 0.50, 0.60)
p.true.5 <- matrix(nrow=4,ncol=4)
p.true.5[1,] <- c(0.15, 0.30, 0.40, 0.45)
p.true.5[2,] <- c(0.30, 0.40, 0.48, 0.50)
p.true.5[3,] <- c(0.42, 0.45, 0.50, 0.52)
p.true.5[4,] <- c(0.48, 0.52, 0.55, 0.58)
p.true.6 <- matrix(nrow=4,ncol=4)
p.true.6[1,] <- c(0.06, 0.08, 0.10, 0.15)
p.true.6[2,] <- c(0.10, 0.18, 0.30, 0.45)
p.true.6[3,] <- c(0.15, 0.30, 0.45, 0.60)
p.true.6[4,] <- c(0.50, 0.55, 0.60, 0.70)
p.true.7 <- matrix(nrow=4,ncol=4)
p.true.7[1,] <- c(0.05, 0.15, 0.30, 0.45)
p.true.7[2,] <- c(0.10, 0.20, 0.40, 0.46)
p.true.7[3,] <- c(0.20, 0.30, 0.45, 0.61)
p.true.7[4,] <- c(0.42, 0.48, 0.60, 0.65)
p.true.8 <- matrix(nrow=4,ncol=4)
p.true.8[1,] <- c(0.15, 0.20, 0.40, 0.56)
p.true.8[2,] <- c(0.20, 0.30, 0.50, 0.60)
p.true.8[3,] <- c(0.40, 0.54, 0.62, 0.68)
p.true.8[4,] <- c(0.50, 0.60, 0.67, 0.73)
p.true.9 <- matrix(nrow=3,ncol=5)
p.true.9[1,] <- c(0.05, 0.10, 0.15, 0.30, 0.45)
p.true.9[2,] <- c(0.10, 0.15, 0.30, 0.45, 0.55)
p.true.9[3,] <- c(0.15, 0.30, 0.45, 0.50, 0.60)
p.true.10 <- matrix(nrow=3,ncol=5)
p.true.10[1,] <- c(0.02, 0.07, 0.10, 0.15, 0.30)
p.true.10[2,] <- c(0.07, 0.10, 0.20, 0.30, 0.55)
p.true.10[3,] <- c(0.30, 0.40, 0.45, 0.55, 0.60)
p.true.11 <- matrix(nrow=3,ncol=5)
p.true.11[1,] <- c(0.07, 0.10, 0.12, 0.30, 0.50)
p.true.11[2,] <- c(0.15, 0.30, 0.45, 0.52, 0.60)
p.true.11[3,] <- c(0.30, 0.45, 0.50, 0.65, 0.75)
p.true.12 <- matrix(nrow=3,ncol=5)
p.true.12[1,] <- c(0.15, 0.20, 0.30, 0.50, 0.60)
p.true.12[2,] <- c(0.20, 0.45, 0.50, 0.60, 0.75)
p.true.12[3,] <- c(0.30, 0.50, 0.60, 0.70, 0.80)
p.true.13 <- matrix(nrow=3,ncol=5)
p.true.13[1,] <- c(0.05, 0.08, 0.10, 0.13, 0.15)
p.true.13[2,] <- c(0.09, 0.12, 0.15, 0.30, 0.45)
p.true.13[3,] <- c(0.15, 0.30, 0.45, 0.50, 0.60)
p.true.14 <- matrix(nrow=3,ncol=5)
p.true.14[1,] <- c(0.30, 0.45, 0.60, 0.70, 0.80)
p.true.14[2,] <- c(0.45, 0.55, 0.65, 0.75, 0.85)
p.true.14[3,] <- c(0.50, 0.60, 0.70, 0.80, 0.90)
p.true.15 <- matrix(nrow=3,ncol=5)
p.true.15[1,] <- c(0.02, 0.07, 0.10, 0.15, 0.30)
p.true.15[2,] <- c(0.07, 0.10, 0.20, 0.30, 0.55)
p.true.15[3,] <- c(0.30, 0.40, 0.45, 0.55, 0.60)
p.true.16 <- matrix(nrow=3,ncol=5)
p.true.16[1,] <- c(0.01, 0.02, 0.08, 0.10, 0.11)
p.true.16[2,] <- c(0.03, 0.05, 0.10, 0.13, 0.15)
p.true.16[3,] <- c(0.07, 0.09, 0.12, 0.15, 0.30)
p1 <- array(c(p.true.1,p.true.2,p.true.3,p.true.4,p.true.5,p.true.6,p.true.7,p.true.8), dim = c(4,4,8))
p2 <- array(c(p.true.9,p.true.10,p.true.11,p.true.12,p.true.13,p.true.14,p.true.15,p.true.16), dim = c(3,5,8))
pq
p1
p2
get.oc.comb(target, p.true.1, ncohort, cohortsize, ntrial=1, seed=1)
res <- get.oc.comb(target, p.true.1, ncohort, cohortsize, ntrial=1, seed=1)
res$selpercent
source("C:/Users/User/Desktop/2D-CFO/2D_CFO_MTD.R", echo=TRUE)
source("C:/Users/User/Desktop/2D-CFO/2D_CFO_MTD.R", echo=TRUE)
boin.simu.fn(target, p.true.1, ncohort, cohortsize, seed=1)
source("C:/Users/User/Desktop/2D-CFO/2D_CFO_MTD.R", echo=TRUE)
source("C:/Users/User/Desktop/2D-CFO/2D_CFO_MTD.R", echo=TRUE)
rand(3,0.1)
rand(3,0.01)
source("C:/Users/User/Desktop/2D-CFO/2D_CFO_MTD.R", echo=TRUE)
rand(3,0.01)
rand <- function(nMTD,e){
repeat{
s <- sample(c(runif_gap(15-nMTD,0,1,e),rep(0.3,nMTD)))
if(length(s[s<=(0.3+e) & s>=(0.3-e)])==nMTD){
break
}
}
m <- matrix(s,3,5)
for (i in 1:3) {
m[i,] <- sort(m[i,])
}
for (j in 1:5) {
m[,j] <- sort(m[,j])
}
return(m)
}
runif_gap <- function(n,min, max, e){
repeat{
s <- sort(runif(n,min,max))
mindiff <- min(diff(s))
if (mindiff >= e){
break
}
}
return(s)
}
check_monoto <- function(phi, p){
a <- which(p==phi, arr.ind = T)
if(length(a[,1])==1){
return(FALSE)
}
for (i in 1:length(a[1,])) {
if(any(duplicated(a[,i]))){
return(TRUE)
}
}
return(FALSE)
}
rand(3,0.01)
random(3,0.01)
source("C:/Users/User/Desktop/2D-CFO/2D_CFO_MTD.R", echo=TRUE)
random(3,5,3,0.01)
random(4,4,3,0.01)
source("C:/Users/User/Desktop/2D-CFO/2D_CFO_MTD.R", echo=TRUE)
random(4,5,4,0.0)
random(4,5,4,0.01)
install.packages("pipe.design")
library(pipe.design)
## Reproducing Figure 5 from Mander and Sweeting, Statistics in Medicine 2015.
## The true probability of DLT for a 6x6 grid of dose combinations
## (Scenario 3 from Mander and Sweeting, Statistics in Medicine 2015)
pi <-matrix(c(0.02,0.10,0.20,0.30,0.35,0.45,0.06,0.14,0.24,0.34,0.39,0.49,0.12,0.20,
0.30,0.40,0.45,0.55,0.17,0.25,0.35,0.45,0.50,0.60,0.22,0.30,0.40,0.50,0.60,0.70,0.30,
0.38,0.48,0.58,0.68,0.78),nrow=6,ncol=6)
## Using a weak prior with prior sample size 1/36 for each dose combination and prior
## median of Scenario 1
prior.med<-matrix(c(0.02,0.03,0.06,0.10,0.18,0.23,0.03,0.05,0.09,0.13,0.21,0.27,0.06,
0.09,0.14,0.18,0.26,0.30,0.11,0.14,0.18,0.23,0.30,0.36,0.18,0.21,0.26,0.30,0.39,0.44,
0.23,0.27,0.3,0.36,0.44,0.49),nrow=6,ncol=6)
## Using a neighbouring escalation constraint
## Selecting the closest admissible doses
## Using a safety constraint with epsilon = 0.8
## Simulating a single trial with sample size of 40, cohort size 2
## and target toxicity of 0.3, using true probabilities of toxicity pi
## Not run:
set.seed(700)
example<-pipe.design(N=40,S=1,c=2,theta=0.3,pi=pi,prior.med=prior.med,
prior.ss=matrix(1/36,ncol=6,nrow=6),strategy="ss",constraint="neighbouring",
epsilon=0.8,admis="closest",alternate=FALSE)
example
plot(example)
## Simulating a single trial with sample size of 40, cohort size 2
## and target toxicity of 0.3, using true probabilities of toxicity pi
## Not run:
set.seed(700)
example<-pipe.design(N=60,S=1,c=3,theta=0.3,pi=pi,prior.med=prior.med,
prior.ss=matrix(1/36,ncol=6,nrow=6),strategy="ss",constraint="neighbouring",
epsilon=0.8,admis="closest",alternate=FALSE)
example$
plot(example)
## Simulating a single trial with sample size of 40, cohort size 2
## and target toxicity of 0.3, using true probabilities of toxicity pi
## Not run:
set.seed(700)
example<-pipe.design(N=60,S=2,c=3,theta=0.3,pi=pi,prior.med=prior.med,
prior.ss=matrix(1/36,ncol=6,nrow=6),strategy="ss",constraint="neighbouring",
epsilon=0.8,admis="closest",alternate=FALSE)
example$
plot(example)
## Simulating a single trial with sample size of 40, cohort size 2
## and target toxicity of 0.3, using true probabilities of toxicity pi
## Not run:
set.seed(700)
example<-pipe.design(N=60,S=1,c=3,theta=0.3,pi=pi,prior.med=prior.med,
prior.ss=matrix(1/36,ncol=6,nrow=6),strategy="ss",constraint="neighbouring",
epsilon=0.8,admis="closest",alternate=FALSE)
example
plot(example)
example$rec
example$exp
example$mat.list
example$pi
prior.med
