"0","line.sampling <- function(phi, ndose, tys, tns, n, lower, upper){"
"0","  samples <- as.list(numeric(ndose))"
"0","  p <- replicate(ndose, 0)"
"0","  nsamples <- 0"
"0","  while (nsamples<n) {"
"0","    s <- replicate(ndose, 0)"
"0","    for (i in 1:ndose) {"
"0","      s[i] <- rbeta(1,phi+tys[i],1-phi+tns[i]-tys[i])"
"0","    }"
"0","    if (all(diff(s) >= 0)){"
"0","      for (j in 1:ndose) {"
"0","        samples[[j]] <- c(samples[[j]],s[j])"
"0","      }"
"0","      nsamples <- nsamples + 1"
"0","    } else {"
"0","      next"
"0","    }"
"0","  }"
"0","  for (k in 1:ndose) {"
"0","    p[k] <- length(samples[[k]][samples[[k]]>lower & samples[[k]]<upper])/length(samples[[k]])"
"0","  }"
"0","  return(p)"
"0","}"
