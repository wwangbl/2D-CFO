"0","sampling <- function(phi, ndose.A, ndose.B, tys, tns, n, lower, upper){"
"0","  samples <- as.list(numeric(ndose.A*ndose.B))"
"0","  dim(samples) <- c(ndose.A,ndose.B)"
"0","  p <- matrix(0,ndose.A,ndose.B)"
"0","  for (i in 1:ndose.A) {"
"0","    for (j in 1:ndose.B) {"
"0","      nsamples <- 0"
"0","      if (i==1 & j==1){"
"0","        next"
"0","      } else {"
"0","        "
"0","        if (i==1){"
"0","          while (nsamples<n) {"
"0","            pl <- rbeta(1,phi+tys[i,j-1],1-phi+tns[i,j-1]-tys[i,j-1])"
"0","            pc <- rbeta(1,phi+tys[i,j],1-phi+tns[i,j]-tys[i,j])"
"0","            if (pl<pc){"
"0","              samples[[i,j-1]] <- c(samples[[i,j-1]],pl)"
"0","              samples[[i,j]] <- c(samples[[i,j]],pc)"
"0","              nsamples <- nsamples + 1"
"0","            }"
"0","          }"
"0","        } else if (j==1){"
"0","          while (nsamples<n) {"
"0","            pd <- rbeta(1,phi+tys[i-1,j],1-phi+tns[i-1,j]-tys[i-1,j])"
"0","            pc <- rbeta(1,phi+tys[i,j],1-phi+tns[i,j]-tys[i,j])"
"0","            if (pd<pc){"
"0","              samples[[i-1,j]] <- c(samples[[i-1,j]],pd)"
"0","              samples[[i,j]] <- c(samples[[i,j]],pc)"
"0","              nsamples <- nsamples + 1"
"0","            }"
"0","          }"
"0","        } else {"
"0","          while (nsamples<n) {"
"0","            pl <- rbeta(1,phi+tys[i,j-1],1-phi+tns[i,j-1]-tys[i,j-1])"
"0","            pd <- rbeta(1,phi+tys[i-1,j],1-phi+tns[i-1,j]-tys[i-1,j])"
"0","            pc <- rbeta(1,phi+tys[i,j],1-phi+tns[i,j]-tys[i,j])"
"0","            if (pl<pc & pd<pc){"
"0","              samples[[i,j-1]] <- c(samples[[i,j-1]],pl)"
"0","              samples[[i-1,j]] <- c(samples[[i-1,j]],pd)"
"0","              samples[[i,j]] <- c(samples[[i,j]],pc)"
"0","              nsamples <- nsamples + 1"
"0","            }"
"0","          }"
"0","        }"
"0","      }"
"0","      "
"0","      p[i,j] <- length(samples[[i,j]][samples[[i,j]]>lower & samples[[i,j]]<upper])/length(samples[[i,j]])"
"0","    }"
"0","  }"
"0",""
"0","  return(p)"
"0","}"
