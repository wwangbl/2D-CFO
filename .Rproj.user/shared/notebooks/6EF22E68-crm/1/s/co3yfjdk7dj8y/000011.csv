"0","y <- c(0,0,1)"
"0","combos <- c(1,1,1)"
"0",""
"0","data<-as.matrix(table(combos,y))"
"0","level<-as.numeric(row.names(data))"
"0","nontox<-as.numeric(data[,1])"
"0","tox<-as.numeric(data[,2])"
"0",""
"0","apred<-rep(0,nrow(alpha))"
"0","	lik<-rep(0,nrow(alpha))"
"0","	for(k in 1:nrow(alpha)){			"
"0","		ll<-function(a){"
"0","			la<-0 #value of the log-likelihood"
"0","			for(i in level){"
"0","			index<-match(i,level)"
"0","			la<-la+tox[index]*a*log(alpha[k,][i])+nontox[index]*log((1-alpha[k,][i]**a))"
"0","			}"
"0","			la"
"0","			}"
"0","		apred[k]<-optimize(f=ll,interval=c(0,500),maximum=T)$maximum"
"0","		lik[k]<-ll(apred[k])"
"0","		}"
"0","pord<-(exp(lik)*prior.o)/sum(exp(lik)*prior.o)"
"0","#library(""nnet"") not necessary because listed as package dependency"
"0","ord<-which.is.max(pord)"
"0","ahat<-apred[ord]"
"0","rpred<-alpha[ord,]**ahat"
"0","next.lev<-which.is.max(-(abs(rpred-theta)))"
"0","out<-list(ord.prob=round(pord,3),order.est=ord,a.est=round(ahat,3),ptox.est=round(rpred,3),dose.rec=next.lev)"
