"0","set.seed(2)"
"0",""
"0","n1<<-n+1"
"0","obs<-data.frame(cbind(1:n1,rep(0,n1),rep(0,n1),rep(0,n1),rep(0,n1)))"
"0","names(obs)<-c('patient','level','tox','a','order')"
"0","i<-1"
"0","#x0<-lapply(zones,ff)"
"0","##'initial.scheme' is a vector indicating the Stage I escalation scheme"
"0","initial.scheme<-x0"
"0","initial.scheme<-c(initial.scheme,rep(ncol(alpha),n1-length(initial.scheme)))"
"0","initial.scheme"
"1"," [1]"
"1","  1"
"1","  1"
"1","  1"
"1","  2"
"1","  2"
"1","  2"
"1","  4"
"1","  4"
"1","  4"
"1","  3"
"1","  3"
"1","  3"
"1","  5"
"1","  5"
"1","  5"
"1","  7"
"1","  7"
"1","  7"
"1","  6"
"1","  6"
"1","  6"
"1","  8"
"1","  8"
"1","  8"
"1"," 10"
"1"," 10"
"1"," 10"
"1","  9"
"1","  9"
"1","  9"
"1"," 11"
"1"," 11"
"1"," 11"
"1"," 13"
"1"," 13"
"1"," 13"
"1"," 12"
"1"," 12"
"1"," 12"
"1"," 14"
"1"," 14"
"1"," 14"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1"," 15"
"1","
"
"1","[61]"
"1"," 15"
"1","
"
"0","obs$level[1:3]<-initial.scheme[1:3]"
"0",""
"0","while(i < n1-3){"
"0","  "
"0","  for (j in i:(i+2)) {"
"0","    obs$order[j]<-99"
"0","    p<-runif(1)"
"0","    # message(p)"
"0","    #number of tox in 1st patient"
"0","    message(j)"
"0","    if(p<=r[obs$level[j]]) {"
"0","      obs$tox[j] <- 1"
"0","    }"
"0","    "
"0","    # message(obs$tox[j])"
"0","  }"
"0","  "
"0","  if(i+3>=stop){"
"0","    MTD <- d"
"0","    break"
"0","  }"
"0","  "
"0","  if(any(obs$tox[i:(i+2)]==1) & any(obs$tox[i:(i+2)]==0)){"
"0","    q<-2"
"0","    break"
"0","  } else if(all(obs$tox[i:(i+2)]==1)){"
"0","    i<-i+3"
"0","    obs$level[i:(i+2)]<-initial.scheme[1:3]"
"0","  } else if (all(obs$tox[i:(i+2)]==0)){"
"0","    i<-i+3"
"0","    obs$level[i:(i+2)]<-initial.scheme[i:(i+2)]"
"0","  }"
"0","}"
"2","1
"
"2","2
"
"2","3
"
"2","4
"
"2","5
"
"2","6
"
"2","7
"
"2","8
"
"2","9
"
"2","10
"
"2","11
"
"2","12
"
"2","13
"
"2","14
"
"2","15
"
"2","16
"
"2","17
"
"2","18
"
"2","19
"
"2","20
"
"2","21
"
