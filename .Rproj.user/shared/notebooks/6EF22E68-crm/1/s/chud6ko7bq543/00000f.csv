"0","pocrm.sim1 <- function(r,alpha,prior.o,x0,n,theta){"
"0","  y <- combos <- c()"
"0","  correct <- npercent <- ntox <- 0"
"0","  for (x in x0) {"
"0","    combos <- c(combos, rep(x,3))"
"0","    "
"0","    for (i in 1:3) {"
"0","      p<-runif(1)"
"0","      if (p<=r[x]){"
"0","        y <- c(y,1)"
"0","      } else {"
"0","        y <- c(y,0)"
"0","      }"
"0","    }"
"0","    "
"0","    if(sum(y)>0){"
"0","      break"
"0","    }"
"0","  }"
"0","  "
"0","  if(length(y)>=n){"
"0","    cat('no MTD is selected')"
"0","    return(list(correct=0, npercent=0, ntox=0))"
"0","  }"
"0","  "
"0","  while (length(y)<n) {"
"0","    idx <- pocrm.imp(alpha,prior.o,theta,y,combos)$dose.rec"
"0","    combos <- c(combos, rep(idx,3))"
"0","    for (i in 1:3) {"
"0","      p<-runif(1)"
"0","      if (p<=r[idx]){"
"0","        y <- c(y,1)"
"0","      } else {"
"0","        y <- c(y,0)"
"0","      }"
"0","    }"
"0","  }"
"0","  "
"0","  MTD <- pocrm.imp(alpha,prior.o,theta,y,combos)$dose.rec"
"0","  ntox <- sum(y)"
"0","  if(r[MTD]==theta){"
"0","    correct <- 1"
"0","  }"
"0","  for (i in 1:length(r)) {"
"0","    if(r[i]==theta){"
"0","      npercent <- npercent + length(which(combos==i))"
"0","    }"
"0","  }"
"0","  npercent <- npercent/n"
"0","  "
"0","  list(correct=correct, npercent=npercent, ntox=ntox)"
"0","}"
