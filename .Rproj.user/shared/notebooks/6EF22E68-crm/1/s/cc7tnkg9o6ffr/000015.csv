"0","N<<-table(obs$level>0)[2]+1"
"0","if(any(obs$tox>0)){"
"0","  level<-crm(obs[1:(N-1),],alpha,prior.o,theta)"
"0","  obs$a[N-1]<-ahat"
"0","  obs$order[N-1]<-ord"
"0","  "
"0","  for(j in N:n1){"
"0","    ##assigment for remaining patients"
"0","    obs$level[j]<-level"
"0","    if(obs$level[n1]>0){"
"0","      MTD<-obs$level[n1]"
"0","      break"
"0","    }"
"0","    "
"0","    if(length(obs$level[obs$level==level])==stop+1){"
"0","      MTD<-level"
"0","      break"
"0","    }"
"0","    "
"0","    # index<-runif(1)<=r[obs$level[j]]"
"0","    if(length(runif(1)<=r[obs$level[N]])==0){obs$tox[j]<-1} #whether tox or not"
"0","    level<-crm(obs[1:j,],alpha,prior.o,theta)"
"0","    obs$a[j]<-ahat"
"0","    obs$order[j]<-ord"
"0","    "
"0","    ##crm dose recommendation for Nth patient"
"0","  }"
"0","} else"
"0","  MTD<-d"
"0","out<-list(trial=obs[obs$level>0,],MTD.selection=MTD)"
"0",""
