"0","set.seed(796)"
"0","y <- combos <- c()"
"0","correct <- npercent <- ntox <- 0"
"0","for (x in x0) {"
"0","  combos <- c(combos, rep(x,3))"
"0","  "
"0","  for (i in 1:3) {"
"0","    p<-runif(1)"
"0","    if (p<=r[x]){"
"0","      y <- c(y,1)"
"0","    } else {"
"0","      y <- c(y,0)"
"0","    }"
"0","  }"
"0","  "
"0","  if(sum(y)>0){"
"0","    break"
"0","  }"
"0","}"
"0",""
"0","if(sum(y)==0){"
"0","  message('no MTD is selected')"
"0","  return(list(correct=0, npercent=0, ntox=0))"
"0","}"
"0",""
"0","data<-as.matrix(table(combos,y))"
"0",""
"0","while (length(y)<n) {"
"0","  idx <- pocrm.imp(alpha,prior.o,theta,y,combos)$dose.rec"
"0","  combos <- c(combos, rep(idx,3))"
"0","  for (i in 1:3) {"
"0","    p<-runif(1)"
"0","    if (p<=r[idx]){"
"0","      y <- c(y,1)"
"0","    } else {"
"0","      y <- c(y,0)"
"0","    }"
"0","  }"
"0","}"
"0",""
