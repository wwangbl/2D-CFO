"0","preliminary <- function(p.true, ndose.A, ndose.B, tys, tns, seed=seed){"
"0","  set.seed(seed)"
"0","  for (i in 1:ndose.A) {"
"0","    tns[i,1] <- tns[i,1] + 1"
"0","    p <- runif(1)"
"0","    if (p<p.true[i,1]){"
"0","      tys[i,1] <- 1"
"0","      position <- which(tys==1, arr.ind = T)"
"0","      if(position[1]!=1){"
"0","        position[1] <- position[1] - 1"
"0","      }"
"0","      return(list(tys=tys, tns=tns, position=position))"
"0","    }"
"0","  }"
"0",""
"0","  for (j in 2:ndose.B) {"
"0","    tns[1,j] <- tns[1,j] + 1"
"0","    p <- runif(1)"
"0","    if (p<p.true[1,j]){"
"0","      tys[1,j] <- 1"
"0","      position <- which(tys==1, arr.ind = T)"
"0","      position[2] <- position[2] - 1"
"0","      return(list(tys=tys, tns=tns, position=position))"
"0","    }"
"0","  }"
"0",""
"0","  return(list(tys=tys, tns=tns, position=c(1,1)))"
"0","}"
